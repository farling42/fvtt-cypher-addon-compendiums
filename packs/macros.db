{"name":"Convert Compendiums","type":"script","author":"GwugNhp2lkJ6dwAa","img":"icons/svg/dice-target.svg","scope":"global","command":"let abilmap = new Map();\ngame.packs.get('cyphersystem-compendium.abilities').index.forEach(index => abilmap.set(index.name, index._id))\n\nfor (const pack of game.packs.filter(pack => pack.metadata.package === 'cypher-addons-compendiums')) {\n  pack.index.forEach(async (index) => {\n    console.log(index.name);\n    let doc = await pack.getDocument(index._id);\n    let text = doc.data.content.replace(/@Compendium\\[cyphersystem-compendium.abilities.([\\w]*)]{([^}]+)}/g,\n      function replacer(match, id, name, offset, string, groups) {\n        let newid = abilmap.get(name);\n        if (!newid) return match;\n        return `@Compendium[cyphersystem-compendium.abilities.${newid}]{${name}}`\n      })\n    \n    doc.update({content: `${text}`});\n  })\n}","folder":null,"sort":0,"flags":{"core":{"sourceId":"Macro.z6DMZGrQ38EzMsFD"}},"_id":"RgTRtlD0dAzbfeYQ","ownership":{"default":0,"GwugNhp2lkJ6dwAa":3},"_stats":{"systemId":"cyphersystem","systemVersion":"2.0.0-b3","coreVersion":"10.288","createdTime":1666952038688,"modifiedTime":1666952168476,"lastModifiedBy":"Qe791PkMD1oOQLN2"}}
